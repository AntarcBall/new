<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style>
        canvas {background: rgb(209, 209, 209);display: block;} 
    </style>
</head>
<body>
    <canvas id='c' height="400" width="600"></canvas>   
    <script>
        
const keys = {};
document.addEventListener('keydown', e => {
    keys[e.key] = true;
})
document.addEventListener('keyup', e => {
    if(keys[e.key]) delete keys[e.key];
})
const size = 45;
const velocity = 2
let cvs = document.getElementById('c')
let pt = cvs.getContext('2d');
var x = cvs.width / 2  
var y = cvs.height / 2
var rock_x = []
var rock_y = []
var makerock= () => {
    rock_x.push(Math.random()*cvs.width)
    rock_y.push(0)
}
var i = 0;
function entitymove_paint(what,number){
    what.arc(rock_x[number],rock_y[number],30,0,Math.PI*2)
}
var game = 1
var distance = (x1,y1,x2,y2) =>Math.sqrt( Math.pow(x2-x1,2) +Math.pow(y2-y1,2))
function Loop(){
    if(keys.a)x -= velocity;//조작 
    if(keys.s) y += velocity;
    if(keys.d) x += velocity;
    if(keys.w) y -= velocity;
    if(x<0) x = 0;//탈출방지 
    if(y<0) y = 0;
    if(x>cvs.width- size) x = cvs.width- size
    if(y>cvs.height- size) y = cvs.height- size

    pt.fillStyle = '#000000'
    
    pt.clearRect(0,0,cvs.width,cvs.height)
    pt.beginPath();
    pt.arc(x,y,size,0,Math.PI*2)
    for (var i in rock_x){
        rock_y[i] += 3
        rock_x[i] += Math.random()*5 -2.5
        if (distance(x,y,rock_x[i],rock_y[i])<30+size) game = 0
        entitymove_paint(pt,i)
        pt.closePath();
    }
    pt.fill()
    if (game) requestAnimationFrame(Loop)
}
requestAnimationFrame(Loop)
setInterval(makerock,1000)

    </script>
</body>
</html>
